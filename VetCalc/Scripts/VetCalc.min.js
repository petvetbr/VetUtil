var zero="0",KeyValue=function(){function n(n,t){this.key=n,this.value=t}return n}(),species,especies=[new KeyValue("canina","Canina"),new KeyValue("felina","Felina"),new KeyValue("bovina","Bovina"),new KeyValue("caprina","Caprina"),new KeyValue("equina","Equina"),new KeyValue("ovina","Ovina"),new KeyValue("suina","Suina")],maxAnimalWeight,minAnimalWeight,DehitrationPercent,kg=0,g=0;$(document).ready(function(){var n=new Ux,t;$("#lbEmail").mouseover(function(){n.showEmail()}),$("#lbMsn").mouseover(function(){n.showMSN()}),$("#dados").draggable(),$("#vitais").draggable(),$("#drogas").draggable(),$("#hidratacao").draggable(),$("#sobre").draggable(),$("#instrucoes").draggable(),$("#ads").draggable(),$("#gestacao").draggable(),ko.applyBindings(vcm),$("#txKg").keyup(function(){n.txWeightChange()}),$("#txKg").change(function(){n.txWeightChange()}),$("#txGrams").keyup(function(){n.txWeightChange()}),$("#txGrams").change(function(){n.txWeightChange()}),$("#txKg").click(function(){n.txWeightChange()}),$("#txGrams").click(function(){n.txWeightChange()}),$("#slSpecies").click(function(){n.SpeciesChange()}),$("#txDosagem").keyup(function(){n.recalcDosage()}),$("#txDosagem").change(function(){n.recalcDosage()}),$("#txDosagem").click(function(){n.recalcDosage()}),$("#slUnidadeDroga").change(function(){n.dosageUnitChange()}),$("#txApresentacao").keyup(function(){n.recalcDosage()}),$("#txApresentacao").change(function(){n.recalcDosage()}),$("#txApresentacao").click(function(){n.recalcDosage()}),$("#slApresentacao").change(function(){n.dosagePresentationChange()}),$("#txHidratacao").keyup(function(){n.Change()}),$("#txHidratacao").change(function(){n.Change()}),$("#txHidratacao").click(function(){n.Change()}),t=new Date,n.bindGestation("#txGestDia",t.getDate()),n.bindGestation("#txGestMes",t.getMonth()+1),n.bindGestation("#txGestAno",t.getFullYear()),n.SpeciesChange(),n.dosageUnitChange()});var Ux=function(){function n(){}return n.prototype.bindGestation=function(n,t){var i=$(n);i.change(function(){Calc.calcGestation()}),t&&i.val(t)},n.prototype.showEmail=function(){$("#lbEmail").text("e-mail/gtalk: petvetbr@gmail.com")},n.prototype.showMSN=function(){$("#lbMsn").text("msn: fe@pobox.com")},n.prototype.ResetValues=function(){maxAnimalWeight=0,vcm.Animal()&&vcm.Animal().Init(),$("#txKg").val(zero),$("#txGrams").val(zero),$("#txDosagem").val(zero),$("#txApresentacao").val(zero),$("#txHidratacao").val(zero),this.txWeightChange()},n.prototype.Change=function(){var n=kg+g/1e3;vcm.Animal()||(vcm.Animal()=ko.observable(new Animal)),vcm.Animal().weightKg=ko.observable(n),vcm.Animal().calcVitals(),this.HidratationChange(),this.recalcDosage(),Calc.calcGestation(),ko.applyBindings(vcm)},n.prototype.SpeciesChange=function(){this.ResetValues(),species=$("#slSpecies").val(),vcm.Animal()||(vcm.Animal()=ko.observable(new Animal)),vcm.Animal().species=species,vcm.Animal().calcVitals(),maxAnimalWeight=vcm.Animal().maxweight(),minAnimalWeight=vcm.Animal().minweight(),this.Change()},n.prototype.dosageUnitChange=function(){var n=$("#slUnidadeDroga :selected").text().split("/")[0];$("#lbUnidadeDose").text(n),this.recalcDosage()},n.prototype.dosagePresentationChange=function(){this.recalcDosage()},n.prototype.recalcDosage=function(){var t=parseFloat($("#txDosagem").val()),i=$("#slUnidadeDroga").val(),r=parseFloat($("#txApresentacao").val()),n=Calc.calcDosage(t,i,r);$("#lbPresentationDosage").text(n.doseApresentacao.toFixed(2)),$("#lbResultadoDose").text(n.dose.toFixed(2))},n.prototype.HidratationChange=function(){DehitrationPercent=$("#txHidratacao").val(),vcm.Animal()&&(vcm.Animal().setDehidrationPercent(DehitrationPercent),vcm.Animal().calcDehitration())},n.prototype.txWeightChange=function(){var n=$("#txKg").val(),t=$("#txGrams").val(),r=Utility.IsNumeric(t,0,999),u=Utility.IsNumeric(n,0,maxAnimalWeight),i,f;u?($("#txKg").css("background-color: #FFFFFF"),kg=parseInt(n)):$("#txKg").css("background-color: #FF6699"),r?($("#txGrams").css("background-color: #FFFFFF"),g=parseInt(t)):$("#txGrams").css("background-color: #FF6699"),i="Peso total: "+kg+" kg "+g+"g",f=kg+g/1e3,$("#lbKg").text(i),this.Change()},n}(),Calc=function(){function n(){}return n.calcGestation=function(){var i=this.ObterDataCruzamento(),n,t,r,u;i?(n=this.ObterDataCruzamento(),n.setDate(i.getDate()+vcm.Animal().gestationPeriodMin()),t=this.ObterDataCruzamento(),t.setDate(i.getDate()+vcm.Animal().gestationPeriodMax()),n&&t&&(r=new Util,$("#lbDataPartoMin").text(r.FormatDate(n)),$("#lbDataPartoMax").text(r.FormatDate(t)))):(u="Data de cruzamento inválida",$("#lbDataPartoMin").text(u),$("#lbDataPartoMax").text(u))},n.ObterDataCruzamento=function(){var t=parseInt($("#txGestDia").val(),10),n=parseInt($("#txGestMes").val(),10),i=parseInt($("#txGestAno").val(),10);if(n>0&&n<=12){if(n===2){if(i%4==0&&i%400!=0){if(t<0||t>29)return null}else if(t<0||t>28)return null}else if(n===1||n===3||n===5||n===7||n===8||n===10||n===12){if(t<0||t>31)return null}else if(t<0||t>30)return null;return new Date(i,n-1,t)}return null},n.calcDosage=function(n,t,i){var e=new dosagem,r=0,f=0,u=0,o=!1,i,s,t;if(isNaN(n))r=null;else{switch(t.substring(2)){case"M2":r=vcm.Animal().areaM2*n,i=parseFloat($("#txApresentacao").val());break;case"10":r=vcm.Animal().weightKg()*n/10,r=r,u=r,o=!0;break;case"100":r=vcm.Animal().weightKg()*n/100,u=r,o=!0;break;default:r=vcm.Animal().weightKg()*n}if(s=t.substring(0,2),f=s=="g"?r*1e3:s=="ug"?r/1e3:r,isNaN(i))o||(u=0);else{t=$("#slApresentacao").val();switch(t){case"mg":u=f/i;break;case"percent":u=f/(i*10);break;case"mg5":u=f/(i/5);break;case"ug":u=f/i*1e3}}}return e.dose=r,e.doseApresentacao=u,e},n}(),Utility=function(){function n(){}return n.isNumber=function(n){return isFinite(n)},n.IsNumeric=function(t,i,r){return n.isNumber(t)&&t>=i&&t<=r?!0:!1},n}(),dosagem=function(){function n(){}return n}(),VetCalcViewModel=function(){function n(){}return n}(),vcm=new VetCalcViewModel;vcm.Animal=ko.observable(new Animal),vcm.Especies=ko.observableArray(especies)